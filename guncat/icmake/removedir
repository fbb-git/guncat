void removeDir(string dir)
{
    list parts;
    int idx;
    int dirIdx;
    list entries;
    int warn = 1;

    parts = strtok(dir, "/");
    chdir(dir);

    echo(OFF);
    
    for (idx = sizeof(parts); idx--; )
    {
        entries = `"ls -A"`;

        if (sizeof(entries) != 0)
        {
            if (warn)
                printf("not removing non-empty dir ", dir, "\n");
            else
            {
                printf("rmdir -r ");
                
                for (dirIdx = 0; dirIdx != idx + 2; ++dirIdx)
                    printf("/", parts[dirIdx]);
                printf("\n");
            }
            return;
        }

        warn = 0;
        chdir("..");
        run("rmdir " + parts[idx]);
    }
}

